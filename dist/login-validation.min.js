function disablePhonenumberInputClickEvents(){$("button#request_otp").prop("disabled",!0),$("input#phone_number").prop("disabled",!0),$("#phoneNumberInput .btn-switch-login").css("pointer-events","none")}function enablePhonenubmerInputClickEvents(){$("button#request_otp").prop("disabled",!1),$("input#phone_number").prop("disabled",!1),$("#phoneNumberInput .btn-switch-login").css("pointer-events","")}function disableOTPEntryClickEvents(){$("button#validate_otp").prop("disabled",!0),$("input#otp_code").prop("disabled",!0),$("#validate-otp-form .login-selection").css("pointer-events","none"),$(".btn-otp-back").css("pointer-events","none")}function enableOTPEntryClickEvents(){$("button#validate_otp").prop("disabled",!1),$("input#otp_code").prop("disabled",!1),$("#validate-otp-form .login-selection").css("pointer-events",""),$(".btn-otp-back").css("pointer-events","")}function showOTPEntryView(){$(".view-group-2").hide(),$(".view_72 .form-cont").removeClass("hidden-block"),$(".otp-back-cont").removeClass("hidden"),$("#login-graphic-2").addClass("img-hidden"),$("#login-graphic-3").removeClass("img-hidden")}function sendOTP(e){$("#kn-loading-spinner").show();let n=$("#country-code-login").val().concat($("#phone_number").val().replace(/^0+/,""));$("#otpNumber").text("+".concat(n)),$.ajax({url:"https://root.ewa-services.com/ewa/send_sms.php?to="+n}).done(function(n){$("#kn-loading-spinner").hide(),e&&e(n)})}function submitOTP(){let e=$("input#otp_code").val();let n=$("#country-code-login").val().concat($("#phone_number").val().replace(/^0+/,""));$("#kn-loading-spinner").show(),disableOTPEntryClickEvents(),$.ajax({url:"https://root.ewa-services.com/ewa/validate_otp.php?to="+n+"&otp="+e}).done(function(e){var n=$.parseJSON(e);$("#kn-loading-spinner").hide(),enableOTPEntryClickEvents(),n.success?($("input#email").val(n.email),$("input#password").val(n.password),$("form.login_form").submit()):alert(n.details)})}function showOTPSentAlert(){$('\n        <div class="alert-otp-resent">\n            <span class="material-icons">\n                chat_bubble\n            </span>\n\n            OTP has been sent\n        </div>\n    ').insertBefore("#validateOTP .view-header"),setTimeout(function(){$(".alert-otp-resent").remove()},5e3)}$.validator.addMethod("phoneValidation",function(e,n){return e=e.replace(/\s+/g,""),"66"==$("#country-code-login").val()?this.optional(n)||9==e.length&&e.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/)||10==e.length&&e.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/)&&"0"==e[0]:"60"==$("#country-code-login").val()?this.optional(n)||9==e.length&&e.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/)||10==e.length&&e.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/)&&"0"==e[0]:"216"==$("#country-code-login").val()?this.optional(n)||8==e.length&&e.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/):"33"==$("#country-code-login").val()?this.optional(n)||9==e.length&&e.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/)||10==e.length&&e.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/)&&"0"==e[0]:void 0},"Please enter a valid phone number"),$.validator.addMethod("malaysianPhone",function(e,n){return e=e.replace(/\s+/g,""),this.optional(n)||10==e.length&&e.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/)||11==e.length&&e.match(/(\d{1,2}\-?\d{3}\-?\d{3,4})/)&&"0"==e[0]},"Please enter a valid phone number");var $phoneNumValidator=$("#otp-input-form").validate({rules:{phone_number:{required:!0,phoneValidation:!0}},messages:{phone_number:"Please enter a valid phone number"},errorPlacement:function(e,n){e.insertAfter(n.parent())},submitHandler:function(e,n){n.preventDefault(),disablePhonenumberInputClickEvents(),sendOTP(e=>{const n=JSON.parse(e);n&&!n.success?(errors={phone_number:n.details},$phoneNumValidator.showErrors(errors)):(enablePhonenubmerInputClickEvents(),showOTPEntryView())})}});$("#validate-otp-form").validate({rules:{otp_code:{required:!0,minlength:4,maxlength:4}},messages:{otp_code:{required:"Please enter a valid OTP code",minlength:"OTP code must be 4 characters",maxlength:"OTP code must be 4 characters"}},errorPlacement:function(e,n){e.insertAfter(n.parent())},submitHandler:function(e,n){n.preventDefault(),submitOTP()}}),$("#validate-otp-form .login-selection").click(()=>{disableOTPEntryClickEvents(),sendOTP(()=>{showOTPSentAlert(),enableOTPEntryClickEvents()})});